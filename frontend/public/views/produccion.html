<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Producción Agrícola</title>
    <link rel="stylesheet" href="../css/pages/produccion.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">Gestión Agrícola</div>
            <div class="user-info">
                <span>Administrador</span>
                <div class="user-avatar">A</div>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="card">
            <h1 class="card-title">Crear Nueva Producción</h1>
            
            <div class="tab-container">
                <div class="tabs">
                    <div class="tab active" data-tab="basic">Información Básica</div>
                    <div class="tab" data-tab="sensors">Sensores</div>
                    <div class="tab" data-tab="supplies">Insumos</div>
                    <div class="tab" data-tab="summary">Resumen</div>
                </div>
            </div>
            
            <form id="productionForm">
                <!-- Información Básica -->
                <div class="tab-content active" id="basic-tab">
                    <div class="form-group">
                        <label for="productionId">Identificador de Producción</label>
                        <input type="text" id="productionId" class="form-control" value="PROD-09042025-0001" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="responsible">Responsable</label>
                        <div class="select-wrapper">
                            <select id="responsible" class="form-control" required>
                                <option value="">Seleccione un responsable</option>
                                <option value="1" selected>Juan Pérez (Usuario actual)</option>
                                <option value="2">María García</option>
                                <option value="3">Carlos López</option>
                            </select>
                        </div>
                        <a class="add-new-link" id="addResponsible">+ Agregar nuevo responsable</a>
                        <div class="error-message" id="responsibleError">Este campo es obligatorio</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="productionName">Nombre de Producción</label>
                        <input type="text" id="productionName" class="form-control" placeholder="Ej: Cultivo de tomates en invernadero" required>
                        <div class="error-message" id="productionNameError">El nombre debe tener entre 3 y 100 caracteres y contener al menos una letra</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="crop">Cultivo</label>
                        <div class="select-wrapper">
                            <select id="crop" class="form-control" required>
                                <option value="">Seleccione un cultivo</option>
                                <option value="1">Tomate</option>
                                <option value="2">Lechuga</option>
                                <option value="3">Papa</option>
                            </select>
                        </div>
                        <a class="add-new-link" id="addCrop">+ Agregar nuevo cultivo</a>
                        <div class="error-message" id="cropError">Este campo es obligatorio</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cropCycle">Ciclo de Cultivo</label>
                        <div class="select-wrapper">
                            <select id="cropCycle" class="form-control" required>
                                <option value="">Seleccione un ciclo de cultivo</option>
                                <option value="1">Primavera-Verano</option>
                                <option value="2">Otoño-Invierno</option>
                                <option value="3">Anual</option>
                            </select>
                        </div>
                        <a class="add-new-link" id="addCropCycle">+ Agregar nuevo ciclo de cultivo</a>
                        <div class="error-message" id="cropCycleError">Este campo es obligatorio</div>
                    </div>
                    
                    <div class="form-group date-inputs">
                        <div class="date-input">
                            <label for="startDate">Fecha de Inicio</label>
                            <input type="date" id="startDate" class="form-control" required>
                        </div>
                        <div class="date-input">
                            <label for="endDate">Fecha de Fin Estimada</label>
                            <input type="date" id="endDate" class="form-control">
                            <div class="error-message" id="endDateError">La fecha de fin debe ser posterior a la fecha de inicio</div>
                        </div>
                    </div>
                </div>
                
                <!-- Sensores -->
                <div class="tab-content" id="sensors-tab">
                    <div class="form-group">
                        <label for="sensor">Sensor</label>
                        <div class="select-wrapper">
                            <select id="sensor" class="form-control">
                                <option value="">Seleccione un sensor</option>
                                <option value="1">Sensor de Humedad del Suelo</option>
                                <option value="2">Sensor de Temperatura Ambiente</option>
                                <option value="3">Sensor de Humedad Relativa</option>
                                <option value="4">Sensor de Luminosidad</option>
                            </select>
                        </div>
                        <a class="add-new-link" id="addSensor">+ Agregar nuevo sensor</a>
                        <div class="error-message" id="sensorError">Puede seleccionar hasta 3 sensores</div>
                    </div>
                    
                    <div class="chip-container" id="selectedSensors">
                        <!-- Chips de sensores seleccionados aparecerán aquí -->
                    </div>
                    
                    <div class="form-group">
                        <label>Visualización de Lecturas</label>
                        <div class="chart-container" id="sensorChart">
                            <p>Seleccione sensores para visualizar los datos</p>
                        </div>
                    </div>
                </div>
                
                <!-- Insumos -->
                <div class="tab-content" id="supplies-tab">
                    <div class="form-group">
                        <label for="supply">Insumo</label>
                        <div class="select-wrapper">
                            <select id="supply" class="form-control">
                                <option value="">Seleccione un insumo</option>
                                <option value="1">Fertilizante NPK</option>
                                <option value="2">Pesticida Orgánico</option>
                                <option value="3">Semillas Híbridas</option>
                                <option value="4">Sustrato para Cultivo</option>
                            </select>
                        </div>
                        <a class="add-new-link" id="addSupply">+ Agregar nuevo insumo</a>
                    </div>
                    
                    <div class="chip-container" id="selectedSupplies">
                        <!-- Chips de insumos seleccionados aparecerán aquí -->
                    </div>
                    
                    <div class="form-group">
                        <button type="button" class="btn btn-secondary" id="addSupplyUsage">+ Registrar uso de insumo</button>
                    </div>
                    
                    <div class="table-responsive">
                        <table id="supplyUsageTable">
                            <thead>
                                <tr>
                                    <th>Insumo</th>
                                    <th>Fecha de Uso</th>
                                    <th>Cantidad</th>
                                    <th>Responsable</th>
                                    <th>Valor Unitario</th>
                                    <th>Valor Total</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Filas de uso de insumos aparecerán aquí -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="form-group">
                        <label>Inversión Total en Insumos</label>
                        <input type="text" id="totalInvestment" class="form-control" value="$0" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label>Meta Estimada</label>
                        <input type="text" id="estimatedGoal" class="form-control" value="$0" readonly>
                    </div>
                </div>
                
                <!-- Resumen -->
                <div class="tab-content" id="summary-tab">
                    <div class="form-group">
                        <h3>Resumen de la Producción</h3>
                        <div id="productionSummary">
                            <p>Complete todos los campos requeridos para ver el resumen</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="chart-container" id="summaryChart">
                            <p>Gráfico de proyección aparecerá aquí</p>
                        </div>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" id="saveDraft">Guardar borrador</button>
                    <button type="submit" class="btn" id="createProduction" disabled>Crear Producción</button>
                </div>
            </form>
        </div>
    </main>
    
    <!-- Modal para agregar nuevo responsable -->
    <div class="modal" id="responsibleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Agregar Nuevo Responsable</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="responsibleForm">
                <div class="form-group">
                    <label for="newResponsibleName">Nombre Completo</label>
                    <input type="text" id="newResponsibleName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newResponsibleEmail">Correo Electrónico</label>
                    <input type="email" id="newResponsibleEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newResponsiblePhone">Teléfono</label>
                    <input type="tel" id="newResponsiblePhone" class="form-control">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn">Guardar</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal para agregar nuevo cultivo -->
    <div class="modal" id="cropModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Agregar Nuevo Cultivo</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="cropForm">
                <div class="form-group">
                    <label for="newCropName">Nombre del Cultivo</label>
                    <input type="text" id="newCropName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newCropDescription">Descripción</label>
                    <textarea id="newCropDescription" class="form-control" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="newCropDuration">Duración Estimada (días)</label>
                    <input type="number" id="newCropDuration" class="form-control" min="1" required>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn">Guardar</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal para agregar nuevo ciclo de cultivo -->
    <div class="modal" id="cropCycleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Agregar Nuevo Ciclo de Cultivo</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="cropCycleForm">
                <div class="form-group">
                    <label for="newCropCycleName">Nombre del Ciclo</label>
                    <input type="text" id="newCropCycleName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newCropCycleDescription">Descripción</label>
                    <textarea id="newCropCycleDescription" class="form-control" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="newCropCycleDuration">Duración Estimada (días)</label>
                    <input type="number" id="newCropCycleDuration" class="form-control" min="1" required>
                </div>
                <div class="form-group">
                    <label for="newCropCycleSeason">Temporada</label>
                    <select id="newCropCycleSeason" class="form-control" required>
                        <option value="">Seleccione una temporada</option>
                        <option value="spring">Primavera</option>
                        <option value="summer">Verano</option>
                        <option value="autumn">Otoño</option>
                        <option value="winter">Invierno</option>
                        <option value="all">Todo el año</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn">Guardar</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal para agregar nuevo sensor -->
    <div class="modal" id="sensorModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Agregar Nuevo Sensor</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="sensorForm">
                <div class="form-group">
                    <label for="newSensorName">Nombre del Sensor</label>
                    <input type="text" id="newSensorName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newSensorType">Tipo de Sensor</label>
                    <select id="newSensorType" class="form-control" required>
                        <option value="">Seleccione un tipo</option>
                        <option value="humidity">Humedad</option>
                        <option value="temperature">Temperatura</option>
                        <option value="light">Luminosidad</option>
                        <option value="ph">pH</option>
                        <option value="other">Otro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newSensorUnit">Unidad de Medida</label>
                    <input type="text" id="newSensorUnit" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newSensorDescription">Descripción</label>
                    <textarea id="newSensorDescription" class="form-control" rows="3"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn">Guardar</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal para agregar nuevo insumo -->
    <div class="modal" id="supplyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Agregar Nuevo Insumo</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="supplyForm">
                <div class="form-group">
                    <label for="newSupplyName">Nombre del Insumo</label>
                    <input type="text" id="newSupplyName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newSupplyType">Tipo de Insumo</label>
                    <select id="newSupplyType" class="form-control" required>
                        <option value="">Seleccione un tipo</option>
                        <option value="fertilizer">Fertilizante</option>
                        <option value="pesticide">Pesticida</option>
                        <option value="seed">Semilla</option>
                        <option value="substrate">Sustrato</option>
                        <option value="other">Otro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newSupplyUnit">Unidad de Medida</label>
                    <input type="text" id="newSupplyUnit" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newSupplyUnitPrice">Precio Unitario</label>
                    <input type="number" id="newSupplyUnitPrice" class="form-control" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="newSupplyDescription">Descripción</label>
                    <textarea id="newSupplyDescription" class="form-control" rows="3"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn">Guardar</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal para registrar uso de insumo -->
    <div class="modal" id="supplyUsageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Registrar Uso de Insumo</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="supplyUsageForm">
                <div class="form-group">
                    <label for="usageSupply">Insumo</label>
                    <div class="select-wrapper">
                        <select id="usageSupply" class="form-control" required>
                            <option value="">Seleccione un insumo</option>
                            <!-- Opciones se llenarán dinámicamente -->
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="usageDate">Fecha de Uso</label>
                    <input type="date" id="usageDate" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="usageQuantity">Cantidad</label>
                    <input type="number" id="usageQuantity" class="form-control" min="0.01" step="0.01" required>
                </div>
                
                <div class="form-group">
                    <label for="usageResponsible">Responsable</label>
                    <div class="select-wrapper">
                        <select id="usageResponsible" class="form-control" required>
                            <option value="">Seleccione un responsable</option>
                            <!-- Opciones se llenarán dinámicamente -->
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="usageUnitPrice">Valor Unitario</label>
                    <input type="number" id="usageUnitPrice" class="form-control" min="0" step="0.01" required>
                </div>
                
                <div class="form-group">
                    <label for="usageTotalPrice">Valor Total</label>
                    <input type="number" id="usageTotalPrice" class="form-control" readonly>
                </div>
                
                <div class="form-group">
                    <label for="usageNotes">Observaciones</label>
                    <textarea id="usageNotes" class="form-control" rows="3"></textarea>
                </div>
                
                <input type="hidden" id="usageId">
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn">Guardar</button>
                </div>
            </form>
        </div>
    </div>
    <script src="../../JS/integracion.js"></script>
</body>
</html>